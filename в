SELECT cu.id,cu.email
FROM
    public.carts ca
    INNER JOIN public.customer cu ON ca.customer_id = cu.id
GROUP BY id,email
ORDER BY SUM(ca.amount) DESC
LIMIT 10